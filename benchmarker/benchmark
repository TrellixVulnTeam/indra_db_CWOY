#!/usr/bin/env python

from datetime import datetime
from argparse import ArgumentParser

from .util import *


def main():
    start_time = datetime.utcnow()
    parser = ArgumentParser(
        description=('Run tests and benchmark time to run and '
                     'errors.'))
    parser.add_argument(dest='location',
                        help='The location of the test file or directory.')
    parser.add_argument(dest='stack_name',
                        help='The name of the Readonly stack being tested.')
    parser.add_argument(dest='api_name',
                        help=('The name of the dependant API being tested. '
                              'This label is used to group test results on s3. '
                              'Whenever possible, try to use existing labels.'))
    args = parser.parse_args()
    results = benchmark(args.location)
    for test, stats in results.items():
        print(test, stats)
    save_results(start_time, args.api_name, args.stack_name, results)


if __name__ == '__main__':
    main()
